creating model...OK
Model: "FaceRecoModel"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 96, 96, 3)]  0                                            
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, 48, 48, 64)   9472        input_1[0][0]                    
__________________________________________________________________________________________________
bn1 (BatchNormalization)        (None, 48, 48, 64)   256         conv1[0][0]                      
__________________________________________________________________________________________________
activation (Activation)         (None, 48, 48, 64)   0           bn1[0][0]                        
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 24, 24, 64)   0           activation[0][0]                 
__________________________________________________________________________________________________
conv2 (Conv2D)                  (None, 24, 24, 64)   4160        max_pooling2d[0][0]              
__________________________________________________________________________________________________
bn2 (BatchNormalization)        (None, 24, 24, 64)   256         conv2[0][0]                      
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 24, 24, 64)   0           bn2[0][0]                        
__________________________________________________________________________________________________
conv3 (Conv2D)                  (None, 24, 24, 192)  110784      activation_1[0][0]               
__________________________________________________________________________________________________
bn3 (BatchNormalization)        (None, 24, 24, 192)  768         conv3[0][0]                      
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 24, 24, 192)  0           bn3[0][0]                        
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 12, 12, 192)  0           activation_2[0][0]               
__________________________________________________________________________________________________
inception_3a_3x3_conv1 (Conv2D) (None, 12, 12, 96)   18528       max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
inception_3a_5x5_conv1 (Conv2D) (None, 12, 12, 16)   3088        max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
inception_3a_3x3_bn1 (BatchNorm (None, 12, 12, 96)   384         inception_3a_3x3_conv1[0][0]     
__________________________________________________________________________________________________
inception_3a_5x5_bn1 (BatchNorm (None, 12, 12, 16)   64          inception_3a_5x5_conv1[0][0]     
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 12, 12, 96)   0           inception_3a_3x3_bn1[0][0]       
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 12, 12, 16)   0           inception_3a_5x5_bn1[0][0]       
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 12, 12, 192)  0           max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
inception_3a_3x3_conv2 (Conv2D) (None, 12, 12, 128)  110720      activation_3[0][0]               
__________________________________________________________________________________________________
inception_3a_5x5_conv2 (Conv2D) (None, 12, 12, 32)   12832       activation_5[0][0]               
__________________________________________________________________________________________________
inception_3a_pool_conv (Conv2D) (None, 12, 12, 32)   6176        max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
inception_3a_1x1_conv (Conv2D)  (None, 12, 12, 64)   12352       max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
inception_3a_3x3_bn2 (BatchNorm (None, 12, 12, 128)  512         inception_3a_3x3_conv2[0][0]     
__________________________________________________________________________________________________
inception_3a_5x5_bn2 (BatchNorm (None, 12, 12, 32)   128         inception_3a_5x5_conv2[0][0]     
__________________________________________________________________________________________________
inception_3a_pool_bn (BatchNorm (None, 12, 12, 32)   128         inception_3a_pool_conv[0][0]     
__________________________________________________________________________________________________
inception_3a_1x1_bn (BatchNorma (None, 12, 12, 64)   256         inception_3a_1x1_conv[0][0]      
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 12, 12, 128)  0           inception_3a_3x3_bn2[0][0]       
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 12, 12, 32)   0           inception_3a_5x5_bn2[0][0]       
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 12, 12, 32)   0           inception_3a_pool_bn[0][0]       
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 12, 12, 64)   0           inception_3a_1x1_bn[0][0]        
__________________________________________________________________________________________________
inception_3a (Concatenate)      (None, 12, 12, 256)  0           activation_4[0][0]               
                                                                 activation_6[0][0]               
                                                                 activation_7[0][0]               
                                                                 activation_8[0][0]               
__________________________________________________________________________________________________
inception_3b_3x3_conv1 (Conv2D) (None, 12, 12, 96)   24672       inception_3a[0][0]               
__________________________________________________________________________________________________
inception_3b_5x5_conv1 (Conv2D) (None, 12, 12, 32)   8224        inception_3a[0][0]               
__________________________________________________________________________________________________
inception_3b_3x3_bn1 (BatchNorm (None, 12, 12, 96)   384         inception_3b_3x3_conv1[0][0]     
__________________________________________________________________________________________________
inception_3b_5x5_bn1 (BatchNorm (None, 12, 12, 32)   128         inception_3b_5x5_conv1[0][0]     
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 12, 12, 96)   0           inception_3b_3x3_bn1[0][0]       
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 12, 12, 32)   0           inception_3b_5x5_bn1[0][0]       
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 12, 12, 256)  0           inception_3a[0][0]               
__________________________________________________________________________________________________
inception_3b_3x3_conv2 (Conv2D) (None, 12, 12, 128)  110720      activation_9[0][0]               
__________________________________________________________________________________________________
inception_3b_5x5_conv2 (Conv2D) (None, 12, 12, 64)   51264       activation_11[0][0]              
__________________________________________________________________________________________________
inception_3b_pool_conv (Conv2D) (None, 12, 12, 64)   16448       average_pooling2d[0][0]          
__________________________________________________________________________________________________
inception_3b_1x1_conv (Conv2D)  (None, 12, 12, 64)   16448       inception_3a[0][0]               
__________________________________________________________________________________________________
inception_3b_3x3_bn2 (BatchNorm (None, 12, 12, 128)  512         inception_3b_3x3_conv2[0][0]     
__________________________________________________________________________________________________
inception_3b_5x5_bn2 (BatchNorm (None, 12, 12, 64)   256         inception_3b_5x5_conv2[0][0]     
__________________________________________________________________________________________________
inception_3b_pool_bn (BatchNorm (None, 12, 12, 64)   256         inception_3b_pool_conv[0][0]     
__________________________________________________________________________________________________
inception_3b_1x1_bn (BatchNorma (None, 12, 12, 64)   256         inception_3b_1x1_conv[0][0]      
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 12, 12, 128)  0           inception_3b_3x3_bn2[0][0]       
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 12, 12, 64)   0           inception_3b_5x5_bn2[0][0]       
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 12, 12, 64)   0           inception_3b_pool_bn[0][0]       
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 12, 12, 64)   0           inception_3b_1x1_bn[0][0]        
__________________________________________________________________________________________________
inception_3b (Concatenate)      (None, 12, 12, 320)  0           activation_10[0][0]              
                                                                 activation_12[0][0]              
                                                                 activation_13[0][0]              
                                                                 activation_14[0][0]              
__________________________________________________________________________________________________
inception_3c_3x3_conv1 (Conv2D) (None, 12, 12, 128)  41088       inception_3b[0][0]               
__________________________________________________________________________________________________
inception_3c_5x5_conv1 (Conv2D) (None, 12, 12, 32)   10272       inception_3b[0][0]               
__________________________________________________________________________________________________
inception_3c_3x3_bn1 (BatchNorm (None, 12, 12, 128)  512         inception_3c_3x3_conv1[0][0]     
__________________________________________________________________________________________________
inception_3c_5x5_bn1 (BatchNorm (None, 12, 12, 32)   128         inception_3c_5x5_conv1[0][0]     
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 12, 12, 128)  0           inception_3c_3x3_bn1[0][0]       
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 12, 12, 32)   0           inception_3c_5x5_bn1[0][0]       
__________________________________________________________________________________________________
inception_3c_3x3_conv2 (Conv2D) (None, 6, 6, 256)    295168      activation_15[0][0]              
__________________________________________________________________________________________________
inception_3c_5x5_conv2 (Conv2D) (None, 6, 6, 64)     51264       activation_17[0][0]              
__________________________________________________________________________________________________
inception_3c_3x3_bn2 (BatchNorm (None, 6, 6, 256)    1024        inception_3c_3x3_conv2[0][0]     
__________________________________________________________________________________________________
inception_3c_5x5_bn2 (BatchNorm (None, 6, 6, 64)     256         inception_3c_5x5_conv2[0][0]     
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 6, 6, 256)    0           inception_3c_3x3_bn2[0][0]       
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 6, 6, 64)     0           inception_3c_5x5_bn2[0][0]       
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 6, 6, 320)    0           inception_3b[0][0]               
__________________________________________________________________________________________________
inception_3c (Concatenate)      (None, 6, 6, 640)    0           activation_16[0][0]              
                                                                 activation_18[0][0]              
                                                                 max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
inception_4a_3x3_conv1 (Conv2D) (None, 6, 6, 96)     61536       inception_3c[0][0]               
__________________________________________________________________________________________________
inception_4a_5x5_conv1 (Conv2D) (None, 6, 6, 32)     20512       inception_3c[0][0]               
__________________________________________________________________________________________________
inception_4a_3x3_bn1 (BatchNorm (None, 6, 6, 96)     384         inception_4a_3x3_conv1[0][0]     
__________________________________________________________________________________________________
inception_4a_5x5_bn1 (BatchNorm (None, 6, 6, 32)     128         inception_4a_5x5_conv1[0][0]     
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 6, 6, 96)     0           inception_4a_3x3_bn1[0][0]       
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 6, 6, 32)     0           inception_4a_5x5_bn1[0][0]       
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 6, 6, 640)    0           inception_3c[0][0]               
__________________________________________________________________________________________________
inception_4a_3x3_conv2 (Conv2D) (None, 6, 6, 192)    166080      activation_19[0][0]              
__________________________________________________________________________________________________
inception_4a_5x5_conv2 (Conv2D) (None, 6, 6, 64)     51264       activation_21[0][0]              
__________________________________________________________________________________________________
inception_4a_pool_conv (Conv2D) (None, 6, 6, 128)    82048       average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
inception_4a_1x1_conv (Conv2D)  (None, 6, 6, 256)    164096      inception_3c[0][0]               
__________________________________________________________________________________________________
inception_4a_3x3_bn2 (BatchNorm (None, 6, 6, 192)    768         inception_4a_3x3_conv2[0][0]     
__________________________________________________________________________________________________
inception_4a_5x5_bn2 (BatchNorm (None, 6, 6, 64)     256         inception_4a_5x5_conv2[0][0]     
__________________________________________________________________________________________________
inception_4a_pool_bn (BatchNorm (None, 6, 6, 128)    512         inception_4a_pool_conv[0][0]     
__________________________________________________________________________________________________
inception_4a_1x1_bn (BatchNorma (None, 6, 6, 256)    1024        inception_4a_1x1_conv[0][0]      
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 6, 6, 192)    0           inception_4a_3x3_bn2[0][0]       
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 6, 6, 64)     0           inception_4a_5x5_bn2[0][0]       
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 6, 6, 128)    0           inception_4a_pool_bn[0][0]       
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 6, 6, 256)    0           inception_4a_1x1_bn[0][0]        
__________________________________________________________________________________________________
inception_4a (Concatenate)      (None, 6, 6, 640)    0           activation_20[0][0]              
                                                                 activation_22[0][0]              
                                                                 activation_23[0][0]              
                                                                 activation_24[0][0]              
__________________________________________________________________________________________________
inception_4e_3x3_conv1 (Conv2D) (None, 6, 6, 160)    102560      inception_4a[0][0]               
__________________________________________________________________________________________________
inception_4e_5x5_conv1 (Conv2D) (None, 6, 6, 64)     41024       inception_4a[0][0]               
__________________________________________________________________________________________________
inception_4e_3x3_bn1 (BatchNorm (None, 6, 6, 160)    640         inception_4e_3x3_conv1[0][0]     
__________________________________________________________________________________________________
inception_4e_5x5_bn1 (BatchNorm (None, 6, 6, 64)     256         inception_4e_5x5_conv1[0][0]     
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 6, 6, 160)    0           inception_4e_3x3_bn1[0][0]       
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 6, 6, 64)     0           inception_4e_5x5_bn1[0][0]       
__________________________________________________________________________________________________
inception_4e_3x3_conv2 (Conv2D) (None, 3, 3, 256)    368896      activation_25[0][0]              
__________________________________________________________________________________________________
inception_4e_5x5_conv2 (Conv2D) (None, 3, 3, 128)    204928      activation_27[0][0]              
__________________________________________________________________________________________________
inception_4e_3x3_bn2 (BatchNorm (None, 3, 3, 256)    1024        inception_4e_3x3_conv2[0][0]     
__________________________________________________________________________________________________
inception_4e_5x5_bn2 (BatchNorm (None, 3, 3, 128)    512         inception_4e_5x5_conv2[0][0]     
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 3, 3, 256)    0           inception_4e_3x3_bn2[0][0]       
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 3, 3, 128)    0           inception_4e_5x5_bn2[0][0]       
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 3, 3, 640)    0           inception_4a[0][0]               
__________________________________________________________________________________________________
inception_4e (Concatenate)      (None, 3, 3, 1024)   0           activation_26[0][0]              
                                                                 activation_28[0][0]              
                                                                 max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
inception_5a_3x3_conv1 (Conv2D) (None, 3, 3, 96)     98400       inception_4e[0][0]               
__________________________________________________________________________________________________
inception_5a_3x3_bn1 (BatchNorm (None, 3, 3, 96)     384         inception_5a_3x3_conv1[0][0]     
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 3, 3, 96)     0           inception_5a_3x3_bn1[0][0]       
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 3, 3, 1024)   0           inception_4e[0][0]               
__________________________________________________________________________________________________
inception_5a_3x3_conv2 (Conv2D) (None, 3, 3, 384)    332160      activation_29[0][0]              
__________________________________________________________________________________________________
inception_5a_pool_conv (Conv2D) (None, 3, 3, 96)     98400       average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
inception_5a_1x1_conv (Conv2D)  (None, 3, 3, 256)    262400      inception_4e[0][0]               
__________________________________________________________________________________________________
inception_5a_3x3_bn2 (BatchNorm (None, 3, 3, 384)    1536        inception_5a_3x3_conv2[0][0]     
__________________________________________________________________________________________________
inception_5a_pool_bn (BatchNorm (None, 3, 3, 96)     384         inception_5a_pool_conv[0][0]     
__________________________________________________________________________________________________
inception_5a_1x1_bn (BatchNorma (None, 3, 3, 256)    1024        inception_5a_1x1_conv[0][0]      
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 3, 3, 384)    0           inception_5a_3x3_bn2[0][0]       
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 3, 3, 96)     0           inception_5a_pool_bn[0][0]       
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 3, 3, 256)    0           inception_5a_1x1_bn[0][0]        
__________________________________________________________________________________________________
inception_5a (Concatenate)      (None, 3, 3, 736)    0           activation_30[0][0]              
                                                                 activation_31[0][0]              
                                                                 activation_32[0][0]              
__________________________________________________________________________________________________
inception_5b_3x3_conv1 (Conv2D) (None, 3, 3, 96)     70752       inception_5a[0][0]               
__________________________________________________________________________________________________
inception_5b_3x3_bn1 (BatchNorm (None, 3, 3, 96)     384         inception_5b_3x3_conv1[0][0]     
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 3, 3, 96)     0           inception_5b_3x3_bn1[0][0]       
__________________________________________________________________________________________________
max_pooling2d_5 (MaxPooling2D)  (None, 3, 3, 736)    0           inception_5a[0][0]               
__________________________________________________________________________________________________
inception_5b_3x3_conv2 (Conv2D) (None, 3, 3, 384)    332160      activation_33[0][0]              
__________________________________________________________________________________________________
inception_5b_pool_conv (Conv2D) (None, 3, 3, 96)     70752       max_pooling2d_5[0][0]            
__________________________________________________________________________________________________
inception_5b_1x1_conv (Conv2D)  (None, 3, 3, 256)    188672      inception_5a[0][0]               
__________________________________________________________________________________________________
inception_5b_3x3_bn2 (BatchNorm (None, 3, 3, 384)    1536        inception_5b_3x3_conv2[0][0]     
__________________________________________________________________________________________________
inception_5b_pool_bn (BatchNorm (None, 3, 3, 96)     384         inception_5b_pool_conv[0][0]     
__________________________________________________________________________________________________
inception_5b_1x1_bn (BatchNorma (None, 3, 3, 256)    1024        inception_5b_1x1_conv[0][0]      
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 3, 3, 384)    0           inception_5b_3x3_bn2[0][0]       
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 3, 3, 96)     0           inception_5b_pool_bn[0][0]       
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 3, 3, 256)    0           inception_5b_1x1_bn[0][0]        
__________________________________________________________________________________________________
inception_5b (Concatenate)      (None, 3, 3, 736)    0           activation_34[0][0]              
                                                                 activation_35[0][0]              
                                                                 activation_36[0][0]              
__________________________________________________________________________________________________
average_pooling2d_3 (AveragePoo (None, 1, 1, 736)    0           inception_5b[0][0]               
__________________________________________________________________________________________________
flatten (Flatten)               (None, 736)          0           average_pooling2d_3[0][0]        
__________________________________________________________________________________________________
dense_layer (Dense)             (None, 128)          94336       flatten[0][0]                    
__________________________________________________________________________________________________
lambda (Lambda)                 (None, 128)          0           dense_layer[0][0]                
==================================================================================================
Total params: 3,743,280
Trainable params: 3,733,968
Non-trainable params: 9,312
__________________________________________________________________________________________________
